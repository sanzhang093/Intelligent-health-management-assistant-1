# 🔒 安全配置说明

## 概述

为了保护您的API密钥和敏感信息，本项目已进行安全配置处理，确保代码可以安全上传到GitHub等公共代码仓库。

## 🛡️ 安全措施

### 1. 环境变量配置
- 所有API密钥已从代码中移除
- 使用环境变量 `DASHSCOPE_API_KEY` 配置API密钥
- 代码会在启动时检查环境变量是否设置

### 2. 文件保护
- 创建了 `.gitignore` 文件，防止敏感文件被提交
- 提供了 `env_example.txt` 作为配置模板
- 敏感信息不会被上传到代码仓库

### 3. 错误处理
- 如果API密钥未设置，程序会给出明确的错误提示
- 提供详细的配置指导

## 🚀 快速配置

### 方法1：使用配置工具（推荐）
```bash
python setup_env.py
```

### 方法2：手动配置

#### Windows系统
```cmd
# 临时设置（当前会话有效）
set DASHSCOPE_API_KEY=your_actual_api_key_here

# 永久设置（系统环境变量）
setx DASHSCOPE_API_KEY "your_actual_api_key_here"
```

#### Linux/macOS系统
```bash
# 临时设置（当前会话有效）
export DASHSCOPE_API_KEY="your_actual_api_key_here"

# 永久设置（添加到 ~/.bashrc 或 ~/.zshrc）
echo 'export DASHSCOPE_API_KEY="your_actual_api_key_here"' >> ~/.bashrc
source ~/.bashrc
```

#### 使用.env文件
1. 复制 `env_example.txt` 为 `.env`
2. 编辑 `.env` 文件，填入真实的API密钥
3. 安装python-dotenv包：`pip install python-dotenv`

## 🔑 获取API密钥

### DashScope API密钥
1. 访问 [阿里云DashScope控制台](https://dashscope.console.aliyun.com/)
2. 注册/登录阿里云账号
3. 创建API密钥
4. 复制密钥并设置到环境变量

## 📁 文件说明

### 新增文件
- `.gitignore` - Git忽略文件，防止敏感信息被提交
- `env_example.txt` - 环境变量配置模板
- `setup_env.py` - 环境配置工具
- `安全配置说明.md` - 本说明文档

### 修改文件
- `src/main_choice.py` - 移除硬编码API密钥
- `src/health_management_agent_enhanced.py` - 移除硬编码API密钥
- `src/health_ask_quickly.py` - 移除硬编码API密钥
- `src/config.py` - 移除硬编码API密钥
- `src/health_management_agent.py` - 移除硬编码API密钥

## ⚠️ 重要提醒

### 安全注意事项
1. **永远不要**将真实的API密钥提交到代码仓库
2. **永远不要**在代码中硬编码API密钥
3. 定期更换API密钥
4. 不要在公共场所或截图中显示API密钥

### 检查清单
在提交代码前，请确认：
- [ ] 所有硬编码的API密钥已移除
- [ ] `.env` 文件已添加到 `.gitignore`
- [ ] 环境变量配置正确
- [ ] 代码可以正常运行

## 🧪 测试配置

### 验证环境变量
```python
import os
api_key = os.getenv('DASHSCOPE_API_KEY')
if api_key:
    print("✅ API密钥已设置")
else:
    print("❌ API密钥未设置")
```

### 测试应用启动
```bash
# 测试主控制器
python src/main_choice.py

# 测试Web界面
python src/health_gui_app_2.py

# 测试桌面应用
python src/health_desktop_app_2.py
```

## 🔧 故障排除

### 常见问题

#### Q1: 提示"请设置环境变量 DASHSCOPE_API_KEY"
**A**: 运行 `python setup_env.py` 或手动设置环境变量

#### Q2: 环境变量设置了但程序还是报错
**A**: 检查环境变量名称是否正确，重启终端/命令行

#### Q3: .env文件不生效
**A**: 确保安装了python-dotenv包，并在代码中加载.env文件

#### Q4: Windows系统环境变量设置不生效
**A**: 使用 `setx` 命令设置系统环境变量，并重启命令行

## 📞 技术支持

如果遇到配置问题，请：
1. 检查本文档的故障排除部分
2. 运行 `python setup_env.py` 进行自动配置
3. 确认API密钥格式正确
4. 检查网络连接

---

**安全提醒**: 请妥善保管您的API密钥，不要与他人分享或在公共场所显示。
